--Query 1: Show the Name, Type and Price of items (products and services) 
--purchased by each customer sorted by customer name

SELECT c.name AS Customer
, p.name AS Item
, p.type
, p.price
FROM customer c 
  INNER JOIN transaction t
    ON c.customer_id = t.customer_id
  INNER JOIN tran_detail td
    ON t.tran_id = td.tran_id
  INNER JOIN product p
    ON td.product_id = p.product_id
ORDER BY c.name;


--Query 2: Show the total spend of each customer sorted by spend descending

SELECT c.name AS Customer
, SUM(td.amount_charged) AS Customer_Spend
FROM customer c 
  INNER JOIN transaction t
    ON c.customer_id = t.customer_id
  INNER JOIN tran_detail td
    ON t.tran_id = td.tran_id
GROUP BY c.name
ORDER BY Customer_Spend DESC;


--Query 3: Show the total revenue generated by each employee sorted by revenue descending

SELECT e.name AS Employee
, SUM(td.amount_charged) AS Customer_Spend
FROM employee e
  INNER JOIN transaction t
    ON e.employee_id = t.employee_id
  INNER JOIN tran_detail td
    ON t.tran_id = td.tran_id
GROUP BY e.name
ORDER BY Customer_Spend DESC;


--Query 4: Show each employee with their title, hire date, manager and manager title

SELECT e.name AS employee_name
, e.title AS emp_title
, e.hire_date AS emp_hire
, m.name AS mgr_name
, m.title AS mgr_title
FROM employee e 
  INNER JOIN employee m
    ON e.manager_id = m.employee_id;

